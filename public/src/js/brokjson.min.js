!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).brok=e()}}(function(){var e={brok2geo:function(e){var r={type:"FeatureCollection"};for(var t in e)["properties","geometries","foreignMembers"].includes(t)||(r[t]=e[t]);r.features=[];var o=function(t){var o=e.geometries[t],n=o.features.map(function(r){var n={};if(r.length>=2)for(var i in r[1]){var s=r[1][i];null!==s&&(n[e.properties[i]]=s)}var p={type:"Feature"};if(Object.keys(n).length>=0&&(p.properties=n),r.length>=3)for(t in r[2])null!==r[2][t]&&e.foreignMembers.length>=t&&(p[e.foreignMembers[t]]=r[2][t]);if("geometrycollection"==o.type.toLowerCase())for(var f in new_coords=[],o.features){var a=o.features[f];for(var l in a[0])for(var u in geocol=a[0][l],geocol.features){types=geocol.features[u];var y={type:geocol.type,coordinates:types[0]};new_coords.push(y)}p.geometry={type:o.type,geometries:new_coords}}else p.geometry={type:o.type,coordinates:r[0]};return p});r.features=r.features.concat(n)};for(var n in e.geometries)o(n);return r},geo2brok:function(e){var r=[],t=[],o=[];for(i in e.features){var n=e.features[i];if("feature"==n.type.toLowerCase()){var s=[];if(n.hasOwnProperty("properties"))for(propertyKey in n.properties){t.includes(propertyKey)||t.push(propertyKey);var p=t.indexOf(propertyKey);s.length-1<p&&(s.length=p+1),s[p]=n.properties[propertyKey]}var f=[];for(item in n)if(!["type","properties","geometry"].includes(item.toLowerCase())){o.includes(item)||o.push(item);var a=o.indexOf(item);f.length-1<a&&(f.length=a+1),f[a]=n[item]}var l=null;if("geometrycollection"==n.geometry.type.toLowerCase())for(iGeom in l=[],n.geometry.geometries){var u=n.geometry.geometries[iGeom];0!=l.length&&l[l.length-1].type.toLowerCase()==u.type.toLowerCase()||l.push({type:u.type,features:[]}),l[l.length-1].features.push([u.coordinates])}else l=n.geometry.coordinates;var y=[l];s.length>0&&y.push(s),f.length>0&&(y.length<2&&y.push(None),y.push(f)),0!=r.length&&r[r.length-1].type.toLowerCase()==n.geometry.type.toLowerCase()||r.push({type:n.geometry.type,features:[]}),r[r.length-1].features.push(y)}}var g={};for(member in t.length>0&&(g.properties=t),o.length>0&&(g.foreignMembers=o),e)["type","features"].includes(member)||(g[member]=e[member]);return r.length>0&&(g.geometries=r),g}};return e});